{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/react-prop-types-to-flow-codemod/","webpackCompilationHash":"2a16616560c583585f4d","result":{"data":{"markdownRemark":{"id":"22a104c8-4e19-54ad-b914-38e28b1f5a5a","excerpt":"I‚Äôm presenting how to automatically convert your existing codebase using React PropTypes to use more powerful Flow annotations. If you already seen why this is‚Ä¶","html":"<p><em>I‚Äôm presenting how to automatically convert your existing codebase using React PropTypes to use more powerful Flow annotations. If you already seen why this is valuable, you can skip down to the next section.</em> üëáüèª</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4822d2d94a48a54d885e84246876a4ac/c35de/flow-unsplash.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 133.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEBQL/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAFU9qhZcCOoWGkZof/EABsQAAMAAwEBAAAAAAAAAAAAAAABEQIDEiIz/9oACAEBAAEFAs8Br09ZsZl9oVcxXoRSs//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABsQAAEEAwAAAAAAAAAAAAAAAAABAhBxESAh/9oACAEBAAY/Arliodhtmdf/xAAcEAADAQEAAwEAAAAAAAAAAAAAAREhMUFhkVH/2gAIAQEAAT8hQnlqKEZalEXW/hTiPLxnweql30Nm/BbfRKl0dxFfp7D/2gAMAwEAAgADAAAAEBDDPP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABwQAQACAgMBAAAAAAAAAAAAAAEAESExQVFhsf/aAAgBAQABPxBbUsA57I46o08TUBrQn5LdumD0hvgtIdWFlmLQF6PKigMkMjkEpV4h3o92f//Z'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Eye candy, because you deserve it (unsplash.com/@thekorus)\"\n        title=\"\"\n        src=\"/static/4822d2d94a48a54d885e84246876a4ac/c739e/flow-unsplash.jpg\"\n        srcset=\"/static/4822d2d94a48a54d885e84246876a4ac/8ee9c/flow-unsplash.jpg 148w,\n/static/4822d2d94a48a54d885e84246876a4ac/ebbe7/flow-unsplash.jpg 295w,\n/static/4822d2d94a48a54d885e84246876a4ac/c739e/flow-unsplash.jpg 590w,\n/static/4822d2d94a48a54d885e84246876a4ac/5413e/flow-unsplash.jpg 885w,\n/static/4822d2d94a48a54d885e84246876a4ac/4efde/flow-unsplash.jpg 1180w,\n/static/4822d2d94a48a54d885e84246876a4ac/c35de/flow-unsplash.jpg 1200w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Eye candy, because you deserve it (unsplash.com/@thekorus)</figcaption>\n  </figure></p>\n<p>If React were Facebook‚Äôs gateway drug to declarative and composable UI, React PropTypes introduced a lot of people to type checking.</p>\n<p>PropTypes documents a given component‚Äôs props and gives runtime validation of props during development. I find them really helpful, but they also have <a href=\"http://technologyadvice.github.io/eradicate-runtime-errors-in-react-with-flow/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">several shortcomings</a>. Most notably we should aim to catch errors before opening our browser. Say hello to static type checking.</p>\n<p>To statically type-check an application, you can use JavaScript extensions like <a href=\"https://flow.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Flow</a> or <a href=\"https://www.typescriptlang.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">TypeScript</a>. In this blog post I‚Äôm focusing on Flow, but the same approach can be applied to TypeScript.</p>\n<h2>No doubt (to me): Static type checking (using Flow or TypeScript) at build time is vastly superior to runtime validation.</h2>\n<p>If you are new to Flow, the <a href=\"https://flow.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">new documentation is really good</a>. After setting up Flow you can now start type annotating your components state and props. For a simple component it might look like:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/* 1) Using good old PropTypes */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Button</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> message <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token operator\">&lt;</span>button<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>message<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\nButton<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  message<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">oneOfType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n    PropTypes<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">,</span>\n    PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">instanceOf</span><span class=\"token punctuation\">(</span>Message<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>isRequired<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/* 2) Using Flow annotations */</span>\ntype Props <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  message<span class=\"token punctuation\">:</span> string <span class=\"token operator\">|</span> number <span class=\"token operator\">|</span> Message<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Button</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> message <span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> Props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token operator\">&lt;</span>button<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>message<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>So far so good. But transitioning an existing codebase to use Flow annotations instead of PropTypes can be tedious‚Ä¶ However this is a perfect task for a codemod!</p>\n<h2>Time to mod the code</h2>\n<p>To automate the conversion of React PropTypes to Flow annotations, we are using another tool popularized by Facebook: <a href=\"https://github.com/facebook/jscodeshift\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">jscodeshift</a> (JavaScript codemod toolkit).</p>\n<p>If the concept of automated refactoring with codemods is new to you, I‚Äôll promote a meetup talk I did: <a href=\"https://www.youtube.com/watch?v=eMI0UBav8Q4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">‚ÄúIntroduction to automated refactoring with JS codemods (Copenhagen.js Meetup, December 2016)‚Äù</a>:</p>\n<p><a href=\"https://www.youtube.com/watch?v=eMI0UBav8Q4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><img src=\"https://img.youtube.com/vi/eMI0UBav8Q4/0.jpg\" alt=\"Introduction to automated refactoring with JS codemods (Copenhagen.js Meetup, December 2016)\"></a></p>\n<p>Enough talk. Time to get rid of the PropTypes! Turns out <a href=\"https://github.com/billyvg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Billy Vong</a> already did a lot of the hard work for us with <a href=\"https://github.com/billyvg/codemod-proptypes-to-flow\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">codemod-proptypes-to-flow</a>.</p>\n<p>So to automatically convert all components in a folder my-components:</p>\n<ul>\n<li><code class=\"language-text\">git clone https://github.com/billyvg/codemod-proptypes-to-flow</code></li>\n<li><code class=\"language-text\">jscodeshift -t codemod-proptypes-to-flow/src/index.js my-components</code></li>\n<li>Look no PropTypes! (Although <code class=\"language-text\">createClass</code>, imported and custom PropTypes validators are not supported‚Ää‚Äî‚Ääyet!)</li>\n</ul>\n<p>I‚Äôve successfully used this codemod for multiple projects, and it eased the transition remarkably. Now Flow starts finding errors while you write code instead of when the code is executed! üç∑ üôåüèª</p>\n<hr>\n<p>Notice that there are cases where you want to keep your PropTypes (possible alongside Flow annotations):</p>\n<ul>\n<li>PropTypes in library code can help consumers and document an interface</li>\n<li>If you have no automated tests validating your flow definitions of any external resources (like an API), PropTypes can be really helpful. For this I would recommend using <a href=\"https://github.com/brigand/babel-plugin-flow-react-proptypes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">babel-plugin-flow-react-proptypes</a> to add PropTypes at build time</li>\n<li>PropTypes are still great for learning material on React (no need to burden new people with Flow/TypeScript)</li>\n<li>PropTypes can be more flexible than what the Flow type-checker currently supports (e.g. <a href=\"https://twitter.com/Daniel15/status/851232924225556480\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">validating a number is in a particular range</a>)</li>\n</ul>\n<hr>\n<p><em>Thanks to <a href=\"https://twitter.com/penzington\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Maciek Pekala</a> and <a href=\"https://twitter.com/Mads_Hartmann\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Mads Hartmann</a> for reviewing this post.</em></p>\n<p><em>This blog post were originally posted on <a href=\"https://hackernoon.com/type-safe-css-modules-with-flow-dd95e761bbe5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">hackernoon</a>.</em></p>","frontmatter":{"title":"React PropTypes to Flow codemod","date":"April 11, 2017","description":"I‚Äôm presenting how to automatically convert your existing codebase using React PropTypes to use more powerful Flow annotations.","featuredImage":{"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEBQL/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAFU9qhZcCOoWGkZof/EABsQAAMBAQADAAAAAAAAAAAAAAABEQISAyIz/9oACAEBAAEFAt4Hn2eDyM19oVcxXoRSs//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABsQAAEEAwAAAAAAAAAAAAAAAAABAhARICFx/9oACAEBAAY/AulQxUNw0vH/xAAcEAADAQEAAwEAAAAAAAAAAAAAAREhMUFRkWH/2gAIAQEAAT8hTcTqKELKUTdb+FHiPLxnweql32hs14y2+iVLo7iK9n6H/9oADAMBAAIAAwAAABAQwwD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAbEAEAAwADAQAAAAAAAAAAAAABABEhMUFRYf/aAAgBAQABPxArCMA79iahRp6hshrgtNR9D6QX1XCHVg1C0hfD8qWA05ggdBKReQ31H2T/2Q==","width":500,"height":500,"src":"/static/4822d2d94a48a54d885e84246876a4ac/56565/flow-unsplash.jpg","srcSet":"/static/4822d2d94a48a54d885e84246876a4ac/56565/flow-unsplash.jpg 1x,\n/static/4822d2d94a48a54d885e84246876a4ac/35a67/flow-unsplash.jpg 1.5x,\n/static/4822d2d94a48a54d885e84246876a4ac/c1b89/flow-unsplash.jpg 2x"}}}}},"site":{"siteMetadata":{"siteUrl":"https://skovhus.github.io"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/react-prop-types-to-flow-codemod/","previous":{"fields":{"slug":"/abandoning-the-mothership/"},"frontmatter":{"title":"Abandoning the mothership"}},"next":{"fields":{"slug":"/type-safe-css-modules-with-flow/"},"frontmatter":{"title":"Type safe CSS Modules with Flow"}}}}}